<core-page-bar [pageTitle]="'Expedientes' | translate"></core-page-bar>

<mat-accordion class="example-headers-align" togglePosition="before" multi>
  <mat-expansion-panel class="cmd-mb-2" expanded="true">
    <mat-expansion-panel-header>
      <mat-panel-title>
        {{ "COMMON.GENERAL_DATA" | translate | sentenceCase }}
      </mat-panel-title>
    </mat-expansion-panel-header>
    <ng-template matExpansionPanelContent>
      <form [formGroup]="fileForm">
        <div class="row">
          <core-basic-input-text
            [id]="'file-code'"
            [label]="'ID Expediente' | translate"
            [hasErrors]="hasControlAnyError('code')"
            formControlName="code"
            class="col s12 l4 cmd-mb-1"
          >
            <ng-container inputErrors>
              <ng-container *ngIf="hasControlAnyError('code')">
                <span
                  *ngIf="hasControlSpecificError('code', 'required')"
                  class="helper-text"
                  [attr.data-error]="'Debe indicar un ID' | translate"
                >
                </span>
              </ng-container>
            </ng-container>
          </core-basic-input-text>

          <core-basic-input-text
            [id]="'file-description'"
            [label]="'Descripción' | translate"
            [hasErrors]="hasControlAnyError('description')"
            formControlName="description"
            class="col s12 l4 cmd-mb-1"
          >
            <ng-container inputErrors>
              <ng-container *ngIf="hasControlAnyError('description')">
                <span
                  *ngIf="hasControlSpecificError('description', 'required')"
                  class="helper-text"
                  [attr.data-error]="'Debe indicar una descripción' | translate"
                >
                </span>
              </ng-container>
            </ng-container>
          </core-basic-input-text>

          <core-basic-input-text
            [id]="'file-status'"
            [label]="'Estado' | translate"
            [hasErrors]="hasControlAnyError('status')"
            formControlName="description"
            class="col s12 l4 cmd-mb-1"
          >
            <ng-container inputErrors>
              <ng-container *ngIf="hasControlAnyError('description')">
                <span
                  *ngIf="hasControlSpecificError('description', 'required')"
                  class="helper-text"
                  [attr.data-error]="'Debe indicar una descripción' | translate"
                >
                </span>
              </ng-container>
            </ng-container>
          </core-basic-input-text>
        </div>

        <div class="row">
          <core-basic-input-text
            [id]="'file-client'"
            [label]="'Cliente' | translate"
            [hasErrors]="hasControlAnyError('client')"
            formControlName="client"
            class="col s12 l4 cmd-mb-1"
          >
            <ng-container inputErrors>
              <ng-container *ngIf="hasControlAnyError('client')">
                <span
                  *ngIf="hasControlSpecificError('client', 'required')"
                  class="helper-text"
                  [attr.data-error]="
                    'Debe indicar un cliente' | translate
                  "
                >
                </span>
              </ng-container>
            </ng-container>
          </core-basic-input-text>
        </div>
      </form>
    </ng-template>
  </mat-expansion-panel>

  <mat-expansion-panel expanded="true">
    <mat-expansion-panel-header>
      <mat-panel-title>
        {{ "Rutas" | translate | sentenceCase }}
      </mat-panel-title>
    </mat-expansion-panel-header>

    <ng-template matExpansionPanelContent>
      <div class="example-table-containe">
        <table
          mat-table
          [dataSource]="dataSource"
          multiTemplateDataRows
          matSort
          class="mat-elevation-z8"
        >
          <ng-container
            matColumnDef="{{ column.label }}"
            *ngFor="let column of columnsToDisplay"
          >
            <th mat-header-cell *matHeaderCellDef mat-sort-header>{{ column.title }}</th>
            <td mat-cell *matCellDef="let element">
              {{ element[column.label] }}
            </td>
          </ng-container>

          <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
          <ng-container matColumnDef="expandedDetail">
            <td
              mat-cell
              *matCellDef="let element"
              [attr.colspan]="columnsToDisplay.length"
            >
              <div
                class="example-element-detail"
                [@detailExpand]="
                  expandedElements.includes(element) ? 'expanded' : 'collapsed'
                "
              >
                Sub-Rutas
              </div>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="columnsProps"></tr>
          <tr
            mat-row
            *matRowDef="let element; columns: columnsProps"
            class="example-element-row"
            [class.example-expanded-row]="expandedElements.includes(element)"
            (click)="expandRow(element)"
          ></tr>
          <tr
            mat-row
            *matRowDef="let row; columns: ['expandedDetail']"
            class="example-detail-row"
          ></tr>
        </table>
      </div>
      <mat-paginator
        [length]="resultsLength"
        [pageSize]="pageSize"
      ></mat-paginator>
    </ng-template>
  </mat-expansion-panel>
</mat-accordion>
