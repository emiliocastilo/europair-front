<core-page-bar [pageTitle]="pageTitle | translate"></core-page-bar>

<section class="save cmd-mt-1">
  <a
    class="waves-effect waves-light btn europair-icon-blue-1 cmd-mr-1 hide-on-small-only"
    [ngClass]="{ disabled: !aircraftForm.valid }"
    (click)="onSaveAircraft()"
  >
    <i class="material-icons left">{{ "save" }}</i>
    {{ "common.save" | translate }}
  </a>
  <div class="fixed-action-btn">
    <a
      class="btn-floating waves-effect waves-light europair-icon-blue-1 cmd-mr-1 hide-on-med-and-up"
      [ngClass]="{ disabled: !aircraftForm.valid }"
      (click)="onSaveAircraft()"
    >
      <i class="material-icons">{{ "save" }}</i>
    </a>
  </div>
</section>

<section class="operator-detail-form cmd-mt-1">
  <form [formGroup]="aircraftForm">
    <ul class="collapsible expandable cmd-mb-2" appMatCollapsible>
      <li class="active">
        <div class="collapsible-header">
          <i class="material-icons">keyboard_arrow_down</i>
          {{ "common.generalData" | translate | sentenceCase }}
        </div>
        <div class="collapsible-body">
          <span>
            <section class="aircraft-detail">
              <div class="row">
                <core-select
                  [customSearchFn]="searchOperator"
                  [hasErrors]="hasControlAnyError('operator')"
                  [id]="'operator-select'"
                  [itemDescription]="selectItemDescription"
                  [items]="operators"
                  [itemValue]="selectItemValue"
                  [label]="'aircraft.operator' | translate | sentenceCase"
                  [placeholder]="'aircraft.operatorPlaceholder' | translate"
                  [searchable]="true"
                  [multiple]="false"
                  class="col s12 l4 cmd-mb-1"
                  formControlName="operator"
                >
                  <ng-container inputErrors>
                    <ng-container *ngIf="hasControlAnyError('operator')">
                      <span
                        *ngIf="
                          this.aircraftForm.get('operator').errors.required
                        "
                        class="helper-text"
                        [attr.data-error]="
                          'aircraft.errors.operator' | translate
                        "
                      >
                      </span>
                    </ng-container>
                  </ng-container>
                </core-select>

                <core-basic-input-text
                  [id]="'aircraft-quantity'"
                  [type]="'number'"
                  [label]="'aircraft.quantity' | translate | sentenceCase"
                  [hasErrors]="hasControlAnyError('quantity')"
                  formControlName="quantity"
                  class="col s12 l4 cmd-mb-1"
                >
                  <ng-container inputErrors>
                    <ng-container *ngIf="hasControlAnyError('quantity')">
                      <span
                        *ngIf="hasControlSpecificError('quantity', 'required')"
                        class="helper-text"
                        [attr.data-error]="
                          'aircraft.errors.quantity' | translate
                        "
                      >
                      </span>
                    </ng-container>
                  </ng-container>
                </core-basic-input-text>
              </div>

              <div class="row">
                <core-select
                  [items]="aircraftTypes"
                  [itemValue]="selectItemValue"
                  [itemDescription]="selectItemDescription"
                  [hasErrors]="hasControlAnyError('aircraftType')"
                  [id]="'id'"
                  [label]="'Tipo'"
                  [searchable]="true"
                  [placeholder]="'aircraft.aircraftTypePlaceholder' | translate"
                  [formControl]="this.aircraftForm.get('aircraftType')"
                  class="col s12 l4 cmd-mb-1"
                >
                  <ng-container inputErrors>
                    <ng-container *ngIf="hasControlAnyError('aircraftType')">
                      <span
                        *ngIf="
                          this.aircraftForm.get('aircraftType').errors.required
                        "
                        class="helper-text"
                        [attr.data-error]="
                          'aircraft.errors.aircraftType' | translate
                        "
                      >
                      </span>
                    </ng-container>
                  </ng-container>
                </core-select>

                <core-basic-input-text
                  [id]="'aircraft-insuranceEndDate'"
                  [type]="'date'"
                  [label]="'aircraft.insuranceEndDate' | translate"
                  [hasErrors]="hasControlAnyError('insuranceEndDate')"
                  formControlName="insuranceEndDate"
                  class="col s12 l4"
                >
                  <ng-container inputErrors>
                    <ng-container
                      *ngIf="hasControlAnyError('insuranceEndDate')"
                    >
                      <span
                        *ngIf="
                          hasControlSpecificError(
                            'insuranceEndDate',
                            'required'
                          )
                        "
                        class="helper-text"
                        [attr.data-error]="
                          'aircraft.errors.insuranceEndDate' | translate
                        "
                      >
                      </span>
                    </ng-container>
                  </ng-container>
                </core-basic-input-text>
              </div>

              <div class="row">
                <core-basic-input-text
                  [id]="'aircraft-productionYear'"
                  [label]="'aircraft.productionYear' | translate"
                  [type]="'number'"
                  [hasErrors]="hasControlAnyError('productionYear')"
                  formControlName="productionYear"
                  class="col s12 l4 cmd-mb-1"
                >
                  <ng-container inputErrors>
                    <ng-container *ngIf="hasControlAnyError('productionYear')">
                      <span
                        *ngIf="
                          hasControlSpecificError('productionYear', 'required')
                        "
                        class="helper-text"
                        [attr.data-error]="
                          'aircraft.errors.productionYear' | translate
                        "
                      >
                      </span>
                    </ng-container>
                  </ng-container>
                </core-basic-input-text>

                <core-basic-input-text
                  [id]="'aircraft-plateNumber'"
                  [label]="'Matrícula'"
                  [hasErrors]="hasControlAnyError('plateNumber')"
                  formControlName="plateNumber"
                  class="col s12 l4 cmd-mb-1"
                >
                  <ng-container inputErrors>
                    <ng-container *ngIf="hasControlAnyError('plateNumber')">
                      <span
                        *ngIf="
                          hasControlSpecificError('plateNumber', 'required')
                        "
                        class="helper-text"
                        [attr.data-error]="
                          'aircraft.errors.plateNumber' | translate
                        "
                      >
                      </span>
                    </ng-container>
                  </ng-container>
                </core-basic-input-text>

                <core-basic-switch
                  [id]="'aircraft-ambulance'"
                  [lastLabel]="'aircraft.ambulance' | translate"
                  formControlName="ambulance"
                  class="col s12 l4 cmd-mt-1"
                >
                </core-basic-switch>
              </div>

              <div class="row">
                <core-basic-input-text
                  [id]="'aircraft-insideUpgradeYear'"
                  [type]="'number'"
                  [label]="'aircraft.insideUpgradeYear' | translate"
                  [hasErrors]="hasControlAnyError('insideUpgradeYear')"
                  formControlName="insideUpgradeYear"
                  class="col s12 l4 cmd-mb-1"
                >
                  <ng-container inputErrors>
                    <ng-container
                      *ngIf="hasControlAnyError('insideUpgradeYear')"
                    >
                      <span
                        *ngIf="
                          hasControlSpecificError(
                            'insideUpgradeYear',
                            'required'
                          )
                        "
                        class="helper-text"
                        [attr.data-error]="
                          'aircraft.errors.insideUpgradeYear' | translate
                        "
                      >
                      </span>
                    </ng-container>
                  </ng-container>
                </core-basic-input-text>

                <core-basic-input-text
                  [id]="'aircraft-outsideUpgradeYear'"
                  [type]="'number'"
                  [label]="'aircraft.outsideUpgradeYear' | translate"
                  [hasErrors]="hasControlAnyError('outsideUpgradeYear')"
                  formControlName="outsideUpgradeYear"
                  class="col s12 l4"
                >
                  <ng-container inputErrors>
                    <ng-container
                      *ngIf="hasControlAnyError('outsideUpgradeYear')"
                    >
                      <span
                        *ngIf="
                          hasControlSpecificError(
                            'outsideUpgradeYear',
                            'required'
                          )
                        "
                        class="helper-text"
                        [attr.data-error]="
                          'aircraft.errors.outsideUpgradeYear' | translate
                        "
                      >
                      </span>
                    </ng-container>
                  </ng-container>
                </core-basic-input-text>
              </div>

              <div class="row valign-wrapper">
                <core-basic-input-text
                  [id]="'aircraft-daytimeConfiguration'"
                  [min]="1"
                  [label]="'aircraft.daytimeConfiguration' | translate"
                  [type]="'number'"
                  [hasErrors]="hasControlAnyError('daytimeConfiguration')"
                  formControlName="daytimeConfiguration"
                  class="col s12 l2 cmd-ml-0"
                >
                  <ng-container inputErrors>
                    <ng-container
                      *ngIf="hasControlAnyError('daytimeConfiguration')"
                    >
                      <span
                        *ngIf="
                          hasControlSpecificError(
                            'daytimeConfiguration',
                            'required'
                          )
                        "
                        class="helper-text"
                        [attr.data-error]="'aircraft.errors.seats' | translate"
                      >
                      </span>
                    </ng-container>
                  </ng-container>
                </core-basic-input-text>

                <div class="col s12 l2 seats-conf cmd-ml-0">
                  <core-basic-input-text
                    [id]="'aircraft-seatingF'"
                    [label]="'aircraft.seatsF' | translate"
                    [min]="minSeats"
                    [type]="'number'"
                    [hasErrors]="hasControlAnyError('seatingF')"
                    formControlName="seatingF"
                    class="col s12 cmd-mb-1"
                  >
                    <ng-container inputErrors>
                      <ng-container *ngIf="hasControlAnyError('seatingF')">
                        <span
                          *ngIf="
                            hasControlSpecificError('seatingF', 'required')
                          "
                          class="helper-text"
                          [attr.data-error]="
                            'aircraft.errors.seats' | translate
                          "
                        >
                        </span>
                      </ng-container>
                    </ng-container>
                  </core-basic-input-text>

                  <core-basic-input-text
                    [id]="'aircraft-seatingC'"
                    [min]="minSeats"
                    [label]="'aircraft.seatsC' | translate"
                    [type]="'number'"
                    [hasErrors]="hasControlAnyError('seatingC')"
                    formControlName="seatingC"
                    class="col s12 cmd-mb-1"
                  >
                    <ng-container inputErrors>
                      <ng-container *ngIf="hasControlAnyError('seatingC')">
                        <span
                          *ngIf="
                            hasControlSpecificError('seatingC', 'required')
                          "
                          class="helper-text"
                          [attr.data-error]="
                            'aircraft.errors.seats' | translate
                          "
                        >
                        </span>
                      </ng-container>
                    </ng-container>
                  </core-basic-input-text>

                  <core-basic-input-text
                    [id]="'aircraft-seatingY'"
                    [min]="minSeats"
                    [label]="'aircraft.seatsY' | translate"
                    [type]="'number'"
                    [hasErrors]="hasControlAnyError('seatingY')"
                    formControlName="seatingY"
                    class="col s12"
                  >
                    <ng-container inputErrors>
                      <ng-container *ngIf="hasControlAnyError('seatingY')">
                        <span
                          *ngIf="
                            hasControlSpecificError('seatingY', 'required')
                          "
                          class="helper-text"
                          [attr.data-error]="
                            'aircraft.errors.seats' | translate
                          "
                        >
                        </span>
                      </ng-container>
                    </ng-container>
                  </core-basic-input-text>
                </div>

                <core-basic-input-text
                  [id]="'aircraft-nighttimeConfiguration'"
                  [min]="1"
                  [label]="'aircraft.nighttimeConfiguration' | translate"
                  [type]="'number'"
                  [hasErrors]="hasControlAnyError('nighttimeConfiguration')"
                  formControlName="nighttimeConfiguration"
                  class="col s12 l2 cmd-ml-0"
                >
                  <ng-container inputErrors>
                    <ng-container
                      *ngIf="hasControlAnyError('nighttimeConfiguration')"
                    >
                      <span
                        *ngIf="
                          hasControlSpecificError(
                            'nighttimeConfiguration',
                            'required'
                          )
                        "
                        class="helper-text"
                        [attr.data-error]="'aircraft.errors.seats' | translate"
                      >
                      </span>
                    </ng-container>
                  </ng-container>
                </core-basic-input-text>
              </div>
            </section>
          </span>
        </div>
      </li>
    </ul>

    <ul
      *ngIf="isAircraftDetail"
      class="collapsible expandable cmd-mb-2"
      appMatCollapsible
    >
      <li>
        <div class="collapsible-header">
          <i class="material-icons">keyboard_arrow_down</i>
          {{ "aircraft.bases" | translate | sentenceCase }}
        </div>
        <div class="collapsible-body">
          <span>
            <section class="cmd-mb-1">
              <core-button-bar
                [barButtons]="aircraftBaseBarButtons"
                [itemsSelectedCount]="aircraftBaseSelectedCount"
                (executeAction)="onBaseBarButtonClicked($event)"
              >
              </core-button-bar>
            </section>
            <section class="aircraft-bases-detail-table">
              <core-table
                [columnsHeader]="aircraftBaseColumnsHeader"
                [columnsData]="aircraftBaseColumnsData"
                [pagination]="aircraftBaseColumnsPagination"
              ></core-table>
            </section>
          </span>
        </div>
      </li>
    </ul>

    <ul
      *ngIf="isAircraftDetail"
      class="collapsible expandable cmd-mb-2"
      appMatCollapsible
    >
      <li>
        <div class="collapsible-header">
          <i class="material-icons">keyboard_arrow_down </i>
          {{ "common.observations" | translate | sentenceCase }}
        </div>
        <div class="collapsible-body">
          <span>
            <section class="cmd-mb-1">
              <core-button-bar
                [barButtons]="aircraftObsBarButtons"
                [itemsSelectedCount]="aircraftObsSelectedCount"
                (executeAction)="onObsBarButtonClicked($event)"
              >
              </core-button-bar>
            </section>
            <section class="aircraft-observations-detail-table">
              <core-table
                [columnsHeader]="aircraftObservationsColumnsHeader"
                [columnsData]="aircraftObservationsColumnsData"
                [pagination]="aircraftObservationsColumnsPagination"
              ></core-table>
            </section>
          </span>
        </div>
      </li>
    </ul>
  </form>
</section>

<app-base-detail
  [title]="modalDetailTitle"
  [baseForm]="aircraftBaseForm"
  (saveBase)="onSaveBase($event)"
></app-base-detail>

<app-observation-detail
  [title]="modalDetailTitle"
  [observationForm]="aircraftObservationForm"
  (saveObservation)="onSaveObservation($event)"
></app-observation-detail>

<core-modal>
  <ng-container content>
    <section class="modal-header">
      <h4>Confirmar eliminación</h4>
      <a class="waves-effect btn-flat modal-close europair-button-blue-1">
        <i class="material-icons right">close</i>
        Cancelar
      </a>
    </section>
    <section class="modal-body">
      <p>
        {{ deleteModalText }}
      </p>
    </section>
  </ng-container>
  <ng-container footer>
    <a
      class="btn modal-close waves-effect europair-icon-blue-1 cmd-w-100"
      (click)="deleteModalAction()"
    >
      <i class="material-icons">check_circle</i>
      <span class="full-width-btn-text">Confirmar</span>
    </a>
  </ng-container>
</core-modal>
